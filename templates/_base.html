<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
  <title>photonicat router login</title>
  {% block html_head0 %}{% endblock %}
  <style type="text/css">
  [x-cloak] { display: none !important; }
  </style>
  <script defer src="/static/alpine-3.10.2.js"></script>
  <link rel="stylesheet" href="/static/app.css?v00023" />
  {% block html_head %}{% endblock %}
</head>

<body class="bg-gray-100 font-sans leading-normal tracking-normal" x-data>
  <div class="bg-white w-full fixed z-10 top-0 shadow px-4 sm:px-0">
    <div class="container mx-auto flex justify-between flex-wrap py-2 sm:py-2">
      <div class="flex"><a
          class="flex items-center text-pcatgray no-underline hover:no-underline text-xl font-title font-bold"
          href="/"><img src="/static/logo.svg" class="mr-2 w-10"> Photonicat
          Admin</a></div>
      <div class="flex flex-grow items-center justify-end text-gray-500 text-sm">


        <a href="/advanced_admin" target="_blank" class="mr-4 flex items-center focus:ring-2 focus:ring-blue-600 hover:underline"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
        </svg> OpenWRT</a>

        <!-- battery -->
        <div class="flex items-center mr-4" x-cloak x-show="$store.app.firmware_exist">
          <div class="flex items-center w-6 h-6 text-center text-gray-700 font-thin">
            <div class="grow border border-gray-700 bg-gray-100 text-[8px] leading-[0.6rem]" x-text="$store.app.charge_percent">0</div>
            <div class="bg-gray-700 w-0.5 h-1.5"></div>
          </div>
          
          <svg x-show="$store.app.on_charging" xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
        </div>
        <!-- /battery -->
        <div class="relative inline-block float-right">
          <div class="relative text-sm" x-data="{ user_menu_open: false, reboot_dlg_open : false, rebooting: false }" >
            <button @click="user_menu_open = true" class="flex items-center focus:outline-none mr-3"><svg
                xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg><span class="hidden md:inline-block">root </span><svg class="pl-1 h-2" version="1.1"
                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 129 129" xmlns:xlink="http://www.w3.org/1999/xlink"
                enable-background="new 0 0 129 129">
                <g>
                  <path
                    d="m121.3,34.6c-1.6-1.6-4.2-1.6-5.8,0l-51,51.1-51.1-51.1c-1.6-1.6-4.2-1.6-5.8,0-1.6,1.6-1.6,4.2 0,5.8l53.9,53.9c0.8,0.8 1.8,1.2 2.9,1.2 1,0 2.1-0.4 2.9-1.2l53.9-53.9c1.7-1.6 1.7-4.2 0.1-5.8z">
                  </path>
                </g>
              </svg>
              <div x-cloak x-show="user_menu_open" @click.outside="user_menu_open = false"
                class="bg-white rounded border shadow-md absolute mt-10 top-0 right-0 w-48 sm:w-32 overflow-auto z-30">
                <ul class="list-reset">
                  <li class="border-b border-gray-100 "><a href="#" @click="reboot_dlg_open = true"
                      class="flex items-center justify-center sm:justify-start px-2 py-4 sm:py-2 text-gray-900 hover:bg-gray-200 no-underline hover:no-underline"><svg
                        class="h-6 w-6 text-black mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                        </path>
                      </svg>{{locales["nav_reboot_device"]}}</a></li>
                  <li class="border-b border-gray-100 "><a href="/logout"
                      class="flex items-center justify-center sm:justify-start px-2 py-4 sm:py-2 text-gray-900 hover:bg-gray-200 no-underline hover:no-underline"><svg
                        xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                        </path>
                      </svg>{{locales["nav_logout"]}}</a></li>
                </ul>
              </div>
            </button>
          
            <!-- reboot modal -->
            <div id="reboot_dlg" class="modal" x-cloak x-data="{rebooting:false}" x-show="reboot_dlg_open" tabindex="-1">
              <section class="modal-main w-full sm:w-1/2" @click.outside="reboot_dlg_open = false">
                <div class="flex justify-between items-start p-3 rounded-t border-b dark:border-gray-600">
                  <h3 class="text-base font-semibold text-gray-900 lg:text-xl dark:text-white">操作提示</h3>
                  <button type="button"
                    class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white"
                    @click="reboot_dlg_open = false"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                      xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd"
                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                        clip-rule="evenodd"></path>
                    </svg></button>
                </div>
                <div class="p-6">
                  <p x-show="!rebooting">你确定要重启设备？</p>
                  <p x-show="rebooting">设备正在重启，请稍候 ...</p>
                </div>
                <div class="flex items-center justify-end p-4 space-x-4 rounded-b border-t border-gray-200 dark:border-gray-600">
                  <span x-show="rebooting" class="text-gray-400 text-sm">请等待大约30秒钟后刷新页面</span>
                  <button x-show="!rebooting" type="button"
                    class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:ring-gray-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 
                      dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600" @click="reboot_dlg_open = false" >取消</button>
                    <button x-show="!rebooting" @click="
                    fetch('/system/reboot', { method: 'POST', headers: { 'Content-Type': 'application/json' }})
                        .then(response => response.json())
                        .then(data => {
                          if(data.status === 'ok') { 
                            rebooting = true;
                          }
                    });
                    " type="button"
                    class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5  text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">确定</button>
                </div>
              </section>
            </div>
            <!-- /reboot modal -->
          
          </div><!-- /relative text-sm -->
        </div>

        <form action="/switch_locale">
          <button class="flex items-center">{{locales["current_locale"]}}
            <svg xmlns="http://www.w3.org/2000/svg" class="ml-1 h-6 w-6 cursor-pointer"
              fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9">
              </path>
            </svg>
          </button>
        </form>
      </div>
    </div>
    <div class="hidden sm:flex container mx-auto w-full flex-grow items-center lg:w-auto bg-white z-20"
      id="nav-content">
      <ul class="list-reset flex flex-1 items-center sm:px-4 md:px-0 justify-between sm:justify-start overflow-x-auto">
        <li class="w-16 sm:w-24"><a class="flex justify-center items-center space-x-2" :class="$store.app.page == 'index' ? 'nav-active' : 'nav'"
            href="/"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-0" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
              </path>
            </svg></a></li>
        <li class="w-16 sm:w-24"><a class="nav flex justify-center items-center space-x-2" :class="$store.app.page == 'settings' ? 'nav-active' : 'nav'" href="/settings"><svg
              xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-0" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
              </path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
              </path>
            </svg></a></li>
        <li class="w-16 sm:w-24"><a class="nav flex justify-center items-center space-x-2" :class="$store.app.page == 'statistics' ? 'nav-active' : 'nav'" href="/statistics"><svg
              xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-0" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
              </path>
            </svg></a></li>
        <li class="w-16 sm:w-24"><a class="nav flex justify-center items-center space-x-2" :class="$store.app.page == 'update' ? 'nav-active' : 'nav'" href="/update"><svg
              xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-0" fill="none" viewBox="0 0 24 24"
              stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
              </path>
            </svg></a></li>
      </ul>
    </div>
  </div><!-- /end nav header -->
  {% block content %}{% endblock %}
  <!--bottom nav -->
  <div class="flex fixed bottom-0 sm:hidden w-full flex-grow items-center bg-gray-200 border-t border-gray-300 z-20"
    id="bottom-nav-content">
    <ul class="list-reset flex flex-1 items-center justify-between  overflow-x-auto">
      <li class="w-24"><a aria-current="page" class="nav-active flex justify-center items-center space-x-2 py-2"
          href="/"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
            </path>
          </svg></a></li>
      <li class="w-24"><a class="nav flex justify-center items-center space-x-2 py-2" href="/settings"><svg
            xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
            </path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
            </path>
          </svg></a></li>
      <li class="w-24"><a class="nav flex justify-center items-center space-x-2 py-2" href="/statistics"><svg
            xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
            </path>
          </svg></a></li>
      <li class="w-24"><a class="nav flex justify-center items-center space-x-2 py-2" href="/update"><svg
            xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
            </path>
          </svg></a></li>
    </ul>
    <div class="hidden sm:block"></div>
  </div>
  <!-- end bottom nav -->
  <footer class="hidden sm:block fixed bottom-0 w-full bg-white border-t border-gray-200 shadow">
    <div class="w-full container mx-auto flex justify-between px-4 sm:px-0 py-4">
      <div>
        <ul class="text-sm flex gap-2 ">
          <li class="text-pcatgray3" x-text="$store.app.date"></li>
          <li class="text-pcatgray3">|</li>
          <li class="text-pcatgray3" x-text="$store.app.time"></li>
          <li class="text-pcatgray3">|</li>
          <li class="text-pcatgray3">Powered by photonicat.com</li>
        </ul>
      </div>
    </div>
  </footer>
<script type="text/javascript">
document.addEventListener('alpine:init', () => {
  Alpine.store('app', {
    fetch_status(){
      fetch('/api/v1/status2.json')
        .then(response => response.json())
        .then(data => {
          this.on_charging = data.on_charging;
          this.firmware_version = data.firmware_version;
          this.charge_percent = data.charge_percent;
          this.date = data.date;
          this.time = data.time;          
          this.car_mode.countdown = data.carmode.countdown;
          this.car_mode.enabled = data.carmode.enabled;
          this.car_mode.timeout = data.carmode.timeout;
        });
    },
    init() {
      this.fetch_status();
      setInterval(() => {
        this.fetch_status();
      }, 2000);
    },
    page: "index",
    on_charging: false,
    firmware_version: "",
    charge_percent: 0,
    date: "",
    time: "",
    car_mode: { countdown: 0, enabled: 'false', timeout: 0 },

    set_page(page) {
      console.log("Set page to", page);
      this.page = page;
    },

    get firmware_exist(){
      return this.firmware_version !== "" && this.firmware_version !== null;
    }
    ////////
  });
});
</script>
{% block bottom %}{% endblock %}
</body>

</html>